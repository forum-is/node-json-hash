{"version":3,"sources":["src/digest.js"],"names":[],"mappings":";;;;QAEgB,MAAM,GAAN,MAAM;;;;;AAAf,SAAS,MAAM,CAAE,CAAC,EAAuF;0CAAJ,EAAE;;4BAAjF,SAAS;MAAT,SAAS,kCAAG,MAAM;gCAAE,aAAa;MAAb,aAAa,sCAAG,MAAM;iCAAE,cAAc;MAAd,cAAc,uCAAG,KAAK;MAAE,MAAM,QAAN,MAAM;;AACrG,MAAI,CAAC,GAAG,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;AACpC,MAAI,CAAC,GAAG;sCAAI,IAAI;AAAJ,UAAI;;;WAAK,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,aAAa,CAAC;GAAA,CAAA;AAC5D,MAAI,CAAC,GAAG,UAAA,CAAC;WAAI,MAAM,CAAC,CAAC,EAAE,EAAE,SAAS,EAAT,SAAS,EAAE,aAAa,EAAb,aAAa,EAAE,cAAc,EAAd,cAAc,EAAE,MAAM,EAAN,MAAM,EAAE,CAAC;GAAA,CAAA;AAC5E,UAAQ,IAAI;;;AAGV,SAAK,OAAO,CAAC,AAAC,KAAK,WAAW;AAC5B,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,YAAM;;AAAA;AAGR,SAAK,CAAC,KAAK,IAAI;AACb,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,YAAK;;AAAA;AAGP,SAAK,OAAO,CAAC,KAAK,SAAS,CAAC;AAC5B,SAAK,CAAC,YAAY,OAAO;AACvB,OAAC,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,CAAA;AACnB,YAAK;;AAAA;AAGP,SAAK,OAAO,CAAC,KAAK,QAAQ,CAAC;AAC3B,SAAK,CAAC,YAAY,MAAM;AACtB,OAAC,CAAC,GAAG,OAAK,CAAC,CAAG,CAAA;AACd,YAAK;;AAAA;AAGP,SAAK,OAAO,CAAC,KAAK,QAAQ,CAAC;AAC3B,SAAK,CAAC,YAAY,MAAM;AACtB,OAAC,CAAC,GAAG,OAAK,CAAC,CAAG,CAAA;AACd,YAAK;;AAAA;AAGP,SAAK,OAAO,CAAC,KAAK,QAAQ;AACxB,OAAC,CAAC,GAAG,OAAK,CAAC,CAAG,CAAA;AACd,YAAK;;AAAA;AAGP,SAAK,CAAC,YAAY,IAAI;AACpB,OAAC,CAAC,GAAG,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC,CAAA;AACvB,YAAK;;AAAA;AAGP,SAAK,CAAC,YAAY,MAAM;AACtB,OAAC,CAAC,GAAG,OAAK,CAAC,CAAG,CAAA;AACd,YAAK;;AAAA;AAGP,SAAK,CAAC,YAAY,QAAQ;AACxB,OAAC,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAA;AACpB,YAAK;;AAAA;AAGP,SAAK,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;AACnB,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,OAAC,CAAC,OAAO,CAAC,UAAA,CAAC;eAAI,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;OAAA,CAAC,CAAA;AAC5B,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,YAAK;;AAAA;AAGP;AACE,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,YAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,UAAC,CAAC;eAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;OAAA,CAAC,CAAA;AAChE,OAAC,CAAC,GAAG,CAAC,CAAA;AACN,YAAK;AAAA,GACR;AACD,SAAO,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAA;CAChC","file":"src/digest.js","sourcesContent":["\r\n// Compute digest for JSON object.\r\nexport function digest (a, { algorithm = 'sha1', inputEncoding = 'utf8', outputEncoding = 'hex', crypto } = {}) {\r\n  let h = crypto.createHash(algorithm)\r\n  let u = (...args) => h.update(args.join(':'), inputEncoding)\r\n  let d = a => digest(a, { algorithm, inputEncoding, outputEncoding, crypto })\r\n  switch (true) {\r\n\r\n    // undefined\r\n    case typeof(a) === 'undefined':\r\n      u('u')\r\n      break;\r\n\r\n    // null\r\n    case a === null:\r\n      u('n')\r\n      break\r\n\r\n    // boolean\r\n    case typeof a === 'boolean':\r\n    case a instanceof Boolean:\r\n      u('f', a.valueOf())\r\n      break\r\n\r\n    // number\r\n    case typeof a === 'number':\r\n    case a instanceof Number:\r\n      u('i', `${a}`)\r\n      break\r\n\r\n    // string\r\n    case typeof a === 'string':\r\n    case a instanceof String:\r\n      u('s', `${a}`)\r\n      break\r\n\r\n    // symbol\r\n    case typeof a === 'symbol':\r\n      u('S', `${a}`)\r\n      break\r\n\r\n    // date\r\n    case a instanceof Date:\r\n      u('d', a.toISOString())\r\n      break\r\n\r\n    // regexp\r\n    case a instanceof RegExp:\r\n      u('x', `${a}`)\r\n      break\r\n\r\n    // function\r\n    case a instanceof Function:\r\n      u('F', a.toString())\r\n      break\r\n\r\n    // array\r\n    case Array.isArray(a):\r\n      u('[')\r\n      a.forEach(e => u('a', d(e)))\r\n      u(']')\r\n      break\r\n\r\n    // object\r\n    default:\r\n      u('{')\r\n      Object.keys(a).sort().forEach((k) => u('k', d(k), 'v', d(a[k])))\r\n      u('}')\r\n      break\r\n  }\r\n  return h.digest(outputEncoding)\r\n}\r\n"]}