{"version":3,"sources":["src/crypto.js"],"names":[],"mappings":"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","file":"src/crypto.js","sourcesContent":["\r\n// var INPUT_ENCODINGS = [ 'binary', 'ascii', 'utf8' ]\r\n// var OUTPUT_ENCODINGS = [ 'binary', 'hex', 'base64' ]\r\n\r\nfunction N(r, a, enc) {\r\n  if (Array.isArray(a)) {\r\n    let n = a.length\r\n    for (let i = 0; i < n; i++) {\r\n      r.push(a[i])\r\n    }\r\n  } else {\r\n    if (enc === 'utf8') {\r\n      let b = unescape(encodeURIComponent(a))\r\n      let n = b.length\r\n      for (let i = 0; i < n; i++) {\r\n        r.push(b.charCodeAt(i))\r\n      }\r\n    } else {\r\n      let n = a.length\r\n      for (let i = 0; i < n; i++) {\r\n        let c = a.charCodeAt(i) & 0xff\r\n        r.push((c === 0 && enc === 'ascii') ? 0x20 : c)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nvar O = function(a, c) {\r\n  let r = null\r\n  let s = function (e) { return String.fromCharCode(e) }\r\n  let h = function (e) { return e.toString(16) }\r\n  switch (c) {\r\n    case 'binary': r = a.map(s).join(''); break\r\n    case 'base64': r = atob(a.map(s).join('')); break\r\n    default: r = a.map(h).join(''); break\r\n  }\r\n  return r\r\n}\r\n\r\nvar R = function (n, s) {\r\n  return (n << s) | (n >>> (32 - s))\r\n}\r\n\r\nfunction SHA1(w) {\r\n\r\n  let n = w.length\r\n  let M = 0x0ffffffff\r\n  let W = new Array(80)\r\n  let H = [0x67452301, 0xEFCDAB89, 0x98BADCFE, 0x10325476, 0xC3D2E1F0]\r\n\r\n  for (var b = 0; b < w.length; b += 16) {\r\n    let A = H[0], B = H[1], C = H[2], D = H[3], E = H[4]\r\n\r\n    for (let i = 0; i < 16; i++) {\r\n      W[i] = w[b + i]\r\n    }\r\n\r\n    for (let i = 16; i <= 79; i++) {\r\n      W[i] = R(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1)\r\n    }\r\n\r\n    for (let i = 0; i <= 19; i++) {\r\n      let t = (R(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & M\r\n      E = D; D = C; C = R(B, 30); B = A; A = t\r\n    }\r\n\r\n    for (let i = 20; i <= 39; i++) {\r\n      let t = (R(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & M\r\n      E = D; D = C; C = R(B, 30); B = A; A = t\r\n    }\r\n\r\n    for (let i = 40; i <= 59; i++) {\r\n      let t = (R(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & M\r\n      E = D; D = C; C = R(B, 30); B = A; A = t\r\n    }\r\n\r\n    for (let i = 60; i <= 79; i++) {\r\n      let t = (R(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & M\r\n      E = D; D = C; C = R(B, 30); B = A; A = t\r\n    }\r\n\r\n    H[0] = (H[0] + A) & M\r\n    H[1] = (H[1] + B) & M\r\n    H[2] = (H[2] + C) & M\r\n    H[3] = (H[3] + D) & M\r\n    H[4] = (H[4] + E) & M\r\n  }\r\n\r\n  return H\r\n}\r\n\r\nfunction createHash(algorithm) {\r\n  let r = null\r\n  switch (algorithm) {\r\n\r\n    // We support SHA1 only for now.\r\n    case 'sha1':\r\n      r = createHashSHA1(algorithm)\r\n      break\r\n\r\n    default:\r\n      throw new Error('Digest method not supported.')\r\n  }\r\n  return r\r\n}\r\n\r\nfunction createHashSHA1() {\r\n  let m = 0\r\n  let c = []\r\n  let r = []\r\n  return {\r\n    update: function (a, e) {\r\n      N(c, a, e)\r\n    },\r\n    digest: function (outputEncoding) {\r\n\r\n      let n = c.length\r\n      for (let i = 0; i < n - 3; i += 4) {\r\n        r.push(\r\n          c[i] << 24 | c[i + 1] << 16 | c[i + 2] << 8 | c[i + 3]\r\n        )\r\n      }\r\n\r\n      switch (n % 4) {\r\n        case 0: r.push(0x080000000); break\r\n        case 1: r.push(c[n - 1] << 24 | 0x0800000); break\r\n        case 2: r.push(c[n - 2] << 24 | c[n - 1] << 16 | 0x08000); break\r\n        case 3: r.push(c[n - 3] << 24 | c[n - 2] << 16 | c[n - 1] << 8 | 0x80); break\r\n      }\r\n      while ((r.length % 16) != 14) {\r\n        r.push(0)\r\n      }\r\n      r.push(n >>> 29)\r\n      r.push((n << 3) & 0x0ffffffff)\r\n\r\n      // r.map(\r\n      //   function (a) {\r\n      //     var r = []\r\n      //     for (var i = 7; i >= 0; --i) {\r\n      //       r.push(((a >>> (i * 4)) & 0x0f).toString(16))\r\n      //     }\r\n      //     return r.join('')\r\n      //   }\r\n      // ).join('')\r\n\r\n      return O(\r\n        SHA1(r).reduce(\r\n          function (r, a) {\r\n            for (let i = 7; i >= 0; --i) {\r\n              r.push(a >>> (i * 4) & 0x0f)\r\n            }\r\n            return r\r\n          }\r\n        , [])\r\n      , outputEncoding)\r\n    }\r\n  }\r\n}\r\n\r\n// if (!module.parent) {\r\n//   var h = createHashSHA1()\r\n//   h.update('hello')\r\n//   console.log(h.digest('hex'))\r\n// }\r\n\r\nmodule.exports = {\r\n  createHash: createHash\r\n}\r\n"]}